var NL_FORM;function isEmailValid(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}function sendEmailToSheet(e){isEmailValid(e)?get("https://script.google.com/macros/s/AKfycbzOOFyPsyXzqytgQK8aWzEI1srgCOhKPTCwFwQ5xys8GXEAJiM/exec?"+("form=newsletter&email="+encodeURIComponent(e))).then(function(){NL_FORM.classList.add("email-sent")}).catch(function(e){console.log("error",e.message)}):NL_FORM.classList.add("form-error")}function mailto(){window.location="mailto:contact@zenbus.fr"}function get(e){return new Promise(function(t,n){var s=new XMLHttpRequest;s.open("GET",e),s.setRequestHeader("Accept","application/json"),s.onload=function(){200==s.status?t(JSON.parse(s.response)):n(s.statusText)},s.send()})}(NL_FORM=document.getElementById("newsletterForm")).addEventListener("submit",function(e){e.preventDefault(),sendEmailToSheet(document.getElementsByName("email")[0].value)});